# Auth κ΄€λ ¨ Util κ°λ°

## λ©ν‘

Auth κ΄€λ ¨ μ ν‹Έμ„ κ°λ°ν•μ—¬, μΈμ¦μ΄ ν•„μ”ν• μΆ…λ‹¨ κ΄€μ‹¬μ‚¬λ“¤μ— κ°λ°μ„ νΈν•κ² ν•λ‹¤.

## λ‹¨κ³„

1. AuthInfo κ°μ²΄μ™€ AuthInfoAffect annotationμ„ μ„ μ–Έν•λ‹¤ (μ£Όμ” μΈν„°νμ΄μ¤κ°€ λ  μμ •)
2. annotionμ paramμ— λ”°λΌ μΈμ¦λμ§€ μ•μ€ μ μ € μ°¨λ‹¨κΈ°λ¥μ„ κ°λ°ν•λ‹¤.
3. annotionμ paramμ— λ”°λΌ AuthInfoλ¥Ό μ£Όμ…ν•΄μ£Όλ” κΈ°λ¥μ„ κ°λ°ν•λ‹¤.
4. annotionμ΄ λ‹¬λ¦° κ°μ²΄μ— λ€ν•΄ Swaggerμ—μ„ μΈμ¦ κΈ°λ¥μ„ λ³΄μ—¬μ£Όλ„λ΅ν•λ‹¤.

## μ™„λ£ AI ν”Όλ“λ°±

### β… μν• μ 

1. **κΉ”λ”ν• μΈν„°νμ΄μ¤ μ„¤κ³„**
   - `AuthInfo` λ°μ΄ν„° ν΄λμ¤λ΅ μΈμ¦ μ •λ³΄λ¥Ό λ…ν™•ν•κ² ν‘ν„
   - `AuthInfoAffect` μ–΄λ…Έν…μ΄μ…μΌλ΅ μ„ μ–Έμ  μΈμ¦ μ²λ¦¬ κ°€λ¥
   - `required` νλΌλ―Έν„°λ΅ ν•„μ/μ„ νƒμ  μΈμ¦μ„ μ μ—°ν•κ² μ§€μ›

2. **Spring ν‘μ¤€ ν¨ν„΄ ν™μ©**
   - `HandlerMethodArgumentResolver`λ¥Ό μ‚¬μ©ν•μ—¬ Springμ ν‘μ¤€ λ©”μ»¤λ‹μ¦ ν™μ©
   - `WebMvcConfigurer`λ¥Ό ν†µν• μ„¤μ •μΌλ΅ ν”„λ μ„μ›ν¬μ™€ μμ—°μ¤λ½κ² ν†µν•©
   - ArgumentResolverλ¥Ό μ°μ„ μμ„ 0μΌλ΅ λ“±λ΅ν•μ—¬ validation μ „μ— μ²λ¦¬ν•λ„λ΅ μ„¤κ³„

3. **λ©”μ†λ“/ν΄λμ¤ λ λ²¨ μ–΄λ…Έν…μ΄μ… μ§€μ›**
   - λ©”μ†λ“ λ λ²¨ μ–΄λ…Έν…μ΄μ…μ΄ ν΄λμ¤ λ λ²¨λ³΄λ‹¤ μ°μ„ μμ„κ°€ λ†’λ„λ΅ κµ¬ν„
   - μ μ—°ν• μ μ© λ²”μ„λ΅ μ½”λ“ μ¤‘λ³µ μµμ†ν™”

4. **μμ΅΄μ„± μ—­μ „ μ›μΉ™ μ μ©**
   - `AuthTokenResolver` μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ κµ¬μ²΄μ μΈ κµ¬ν„κ³Ό λ¶„λ¦¬
   - ν…μ¤νΈ μ©μ΄μ„±κ³Ό ν™•μ¥μ„± ν–¥μƒ

5. **Swagger ν†µν•© μ™„μ„±λ„**
   - `OperationCustomizer`λ¥Ό ν†µν•΄ μλ™μΌλ΅ Security μ”κµ¬μ‚¬ν•­ μ¶”κ°€
   - AuthInfo νλΌλ―Έν„°λ¥Ό Swagger λ¬Έμ„μ—μ„ μλ™ μ κ±°ν•μ—¬ μ‚¬μ©μ κ²½ν— κ°μ„ 
   - Bearer Token μ¤ν‚΄μ„ λ…ν™•ν•κ² μ„¤μ •

6. **λ…ν™•ν• λ¬Έμ„ν™”**
   - KDoc μ£Όμ„μΌλ΅ κ° μ»΄ν¬λ„νΈμ μ—­ν• κ³Ό μ‚¬μ©λ²• μ„¤λ…
   - μμ  μ½”λ“ ν¬ν•¨μΌλ΅ μ΄ν•΄λ„ ν–¥μƒ

7. **μ—λ¬ μ²λ¦¬**
   - `DomainException`μ„ ν†µν• μΌκ΄€λ μ—λ¬ μ²λ¦¬
   - `required`μ— λ”°λ¥Έ μ μ ν• μμ™Έ λ°μƒ λλ” null λ°ν™

### β οΈ κ°μ„ ν•  μ 

1. **ArgumentResolver λ΅μ§ κ°μ„ **
   - `supportsParameter`μ—μ„ μ–΄λ…Έν…μ΄μ… μ²΄ν¬λ¥Ό ν•μ§€ μ•μ•„, μ–΄λ…Έν…μ΄μ…μ΄ μ—†λ” λ©”μ†λ“μ—μ„λ„ AuthInfo νλΌλ―Έν„°λ¥Ό μ²λ¦¬ν•λ ¤κ³  μ‹λ„
   - μ–΄λ…Έν…μ΄μ…μ΄ μ—†λ” κ²½μ° λ” μΌμ° λ°ν™ν•μ—¬ λ¶ν•„μ”ν• μ²λ¦¬ λ°©μ§€ κ³ λ ¤

1. **μ—λ¬ λ©”μ‹μ§€ μΌκ΄€μ„±**
   - μΌλ¶€ μ—λ¬ λ©”μ‹μ§€κ°€ μμ–΄λ΅ λμ–΄ μμ (`"Authorization header is missing"`)
   - ν”„λ΅μ νΈ μ „λ°μ μ–Έμ–΄ μ •μ±…μ— λ§μ¶° μΌκ΄€μ„± μ μ§€ ν•„μ”

1. **OpenApiConfig λ³µμ΅λ„**
   - νλΌλ―Έν„° μ κ±° λ΅μ§μ΄ λ‹¤μ† λ³µμ΅ν•¨ (μ΄λ¦„ κΈ°λ° β†’ μΈλ±μ¤ κΈ°λ° fallback)
   - `SpringDocUtils.getConfig().addRequestWrapperToIgnore()` κ°™μ€ μ „μ—­ μ„¤μ • ν™μ© κ²€ν†  κ°€λ¥

1. **ν…μ¤νΈ μ½”λ“ λ¶€μ¬**
   - `AuthInfoArgumentResolver`μ— λ€ν• λ‹¨μ„ ν…μ¤νΈ ν•„μ”
   - `OpenApiConfig`μ OperationCustomizer λ™μ‘ κ²€μ¦ ν•„μ”
   - ν†µν•© ν…μ¤νΈλ΅ μ „μ²΄ ν”λ΅μ° κ²€μ¦ κ¶μ¥

1. **null μ•μ „μ„±**
   - Kotlinμ null μ•μ „μ„± ν™μ©μ„ λ” κ°•ν™”ν•  μ μμ
   - `AuthInfo?`μ™€ `AuthInfo` νƒ€μ… κµ¬λ¶„μ„ λ” λ…ν™•ν•κ² μ²λ¦¬

1. **μ„±λ¥ κ³ λ ¤μ‚¬ν•­**
   - μ–΄λ…Έν…μ΄μ… μ²΄ν¬κ°€ λ§¤ μ”μ²­λ§λ‹¤ λ°μƒν•λ―€λ΅, μΊμ‹± μ „λµ κ³ λ ¤ κ°€λ¥
   - ν•μ§€λ§ ν„μ¬ κµ¬ν„λ„ μ¶©λ¶„ν ν¨μ¨μ μ„

### π“ μΆ…ν•© ν‰κ°€

**μ „μ²΄μ μΌλ΅ λ§¤μ° μ κµ¬ν„λ κΈ°λ¥μ…λ‹λ‹¤!** 

λ©ν‘ν–λ 4κ°€μ§€ λ‹¨κ³„λ¥Ό λ¨λ‘ μ™„λ£ν–μΌλ©°, Springμ ν‘μ¤€ ν¨ν„΄μ„ μ ν™μ©ν•κ³  μμµλ‹λ‹¤. νΉν Swagger ν†µν•© λ¶€λ¶„μ΄ μΈμƒμ μ…λ‹λ‹¤. λ‡ κ°€μ§€ μ‘μ€ κ°μ„ μ λ“¤μ΄ μμ§€λ§, μ „λ°μ μΌλ΅ ν”„λ΅λ•μ…μ— μ‚¬μ© κ°€λ¥ν• μμ¤€μ μ½”λ“μ…λ‹λ‹¤.

**μ¶”κ°€ κ¶μ¥μ‚¬ν•­:**
- ν…μ¤νΈ μ½”λ“ μ‘μ„±μΌλ΅ μ•μ •μ„± ν™•λ³΄
- λ¬Έμ„ μ¤νƒ€ μμ •
- μ—λ¬ λ©”μ‹μ§€ μΌκ΄€μ„± κ°μ„ 
